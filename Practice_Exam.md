# מבחן הכנה - SQL Practice Exam
## חנות אינטרנטית - E-Commerce Database

### הוראות למבחן:
- זמן: 90 דקות
- ענו על כל השאלות
- השתמשו בקבצים:
  - `practice_exam_data.csv` → טבלת **orders**
  - `practice_exam_customers.csv` → טבלת **customers**
- וודאו שהשאילתות שלכם מחזירות את התוצאות הנכונות

---

## חלק א': שאלות בסיסיות (20 נקודות)

### שאלה 1 (4 נקודות)
כתבו שאילתה שמחזירה את כל ההזמנות מקטגוריית **Electronics** בלבד.

הציגו: `order_id`, `customer_name`, `product_name`, `price_per_unit`

---

### שאלה 2 (4 נקודות)
כתבו שאילתה שמחזירה את שמות כל הלקוחות הייחודיים שהזמינו ב-**PayPal**.

מיינו לפי שם לקוח בסדר אלפביתי.

---

### שאלה 3 (4 נקודות)
כתבו שאילתה שמחזירה את כמות ההזמנות הכוללת לכל קטגוריית מוצר.

הציגו: `product_category`, `total_orders`

מיינו לפי כמות ההזמנות בסדר יורד.

---

### שאלה 4 (4 נקודות)
כתבו שאילתה שמחזירה את כל ההזמנות שהתבצעו בחודש **פברואר 2024**.

הציגו: `order_id`, `customer_name`, `order_date`, `product_name`

---

### שאלה 5 (4 נקודות)
כתבו שאילתה שמחזירה את המחיר הממוצע למוצר בכל קטגוריה.

הציגו: `product_category`, `avg_price`

עגלו את התוצאה ל-2 ספרות אחרי הנקודה.

---

## חלק ב': שאלות ביניים (30 נקודות)

### שאלה 6 (6 נקודות)
כתבו שאילתה שמחזירה את **5 הלקוחות** שהוציאו הכי הרבה כסף (סכום כולל).

חשבו: `quantity * price_per_unit` לכל הזמנה.

הציגו: `customer_name`, `email`, `total_spent`

מיינו לפי הסכום הכולל בסדר יורד.

**רמז:** צריך לעשות JOIN בין orders ל-customers

---

### שאלה 7 (6 נקודות)
כתבו שאילתה שמחזירה לכל **Loyalty Tier** (רמת נאמנות):
- כמה לקוחות יש
- סך ההכנסות מהם
- ממוצע הזמנות ללקוח

הציגו: `loyalty_tier`, `customer_count`, `total_revenue`, `avg_orders_per_customer`

מיינו לפי סך ההכנסות בסדר יורד.

---

### שאלה 8 (6 נקודות)
כתבו שאילתה שמחזירה את הכנסות החודשיות (revenue) לכל חודש.

הציגו: `month`, `monthly_revenue`

השתמשו בפורמט: `YYYY-MM` לחודש.

מיינו לפי חודש.

---

### שאלה 9 (6 נקודות)
כתבו שאילתה שמחזירה את הלקוחות שביצעו **יותר מ-3 הזמנות**.

הציגו: `customer_name`, `number_of_orders`, `total_spent`

מיינו לפי כמות ההזמנות בסדר יורד.

---

### שאלה 10 (6 נקודות)
כתבו שאילתה שמחזירה את הלקוחות ב-**Platinum tier** שלא ביצעו הזמנה בחודש אפריל 2024.

הציגו: `customer_name`, `email`, `loyalty_tier`, `last_order_date`

**רמז:** השתמשו ב-LEFT JOIN או NOT EXISTS

---

## חלק ג': שאלות מתקדמות (30 נקודות)

### שאלה 11 (7 נקודות)
כתבו שאילתה שמשווה בין לקוחות **חדשים** (נרשמו אחרי 1/7/2023) ללקוחות **ותיקים** (נרשמו לפני):
- כמות לקוחות
- סך הכנסות
- ממוצע הוצאה ללקוח

הציגו: `customer_type`, `customer_count`, `total_revenue`, `avg_revenue_per_customer`

---

### שאלה 12 (8 נקודות)
כתבו שאילתה שמחזירה לכל לקוח:
- שם הלקוח
- הקטגוריה בה הוא הוציא הכי הרבה כסף
- הסכום שהוציא בקטגוריה זו
- אחוז ההוצאה בקטגוריה זו מסך ההוצאות שלו

הציגו: `customer_name`, `top_category`, `category_spending`, `percentage_of_total`

**רמז:** השתמשו ב-Window Functions

---

### שאלה 13 (7 נקודות)
כתבו שאילתה שמחזירה את הלקוחות שקנו מוצרים ב**לפחות 3 קטגוריות שונות**.

הציגו: `customer_name`, `email`, `loyalty_tier`, `number_of_categories`, `total_orders`

מיינו לפי כמות הקטגוריות בסדר יורד.

---

### שאלה 14 (8 נקודות)
צרו שאילתה שמציגה **Ranking** של הלקוחות לפי הכנסות **בתוך כל Loyalty Tier**.

השתמשו ב-`RANK()` או `ROW_NUMBER()`.

הציגו: `loyalty_tier`, `customer_name`, `email`, `total_revenue`, `rank_in_tier`

הציגו רק את **3 הלקוחות המובילים** בכל Tier.

---

## חלק ד': שאלות אתגר (20 נקודות)

### שאלה 15 (10 נקודות)
כתבו שאילתה שמזהה **אי התאמות** בין:
- `total_lifetime_orders` בטבלת customers
- מספר ההזמנות האמיתי בטבלת orders

הציגו: `customer_name`, `email`, `recorded_orders` (מהטבלה), `actual_orders` (ספירה אמיתית), `difference`

הציגו רק לקוחות שיש אי התאמה.

**רמז:** זו בדיקת Data Quality!

---

### שאלה 16 (10 נקודות)
כתבו שאילתה שמחשבת **Customer Retention Rate** - אחוז הלקוחות שקנו גם בחודש הקודם.

לכל חודש (פברואר-אפריל 2024), הציגו:
- החודש
- כמה לקוחות קנו בחודש זה
- כמה מהם קנו גם בחודש הקודם
- אחוז ה-Retention

הציגו: `month`, `customers_this_month`, `returning_customers`, `retention_rate`

**רמז:** זו שאלה מאתגרת שדורשת Self-Join או Window Functions מתקדמים.

---

## בונוס - שאלת SQL מתקדם (10 נקודות)

### שאלה 17 - BONUS
כתבו שאילתה שמוצאת **Cohort Analysis** - ניתוח התנהגות לקוחות לפי חודש הרשמה.

לכל חודש רשמה (registration month), הציגו:
- החודש
- כמה לקוחות נרשמו
- כמה מהם ביצעו הזמנה בחודש הראשון
- כמה ביצעו הזמנה בחודש השני
- כמה ביצעו הזמנה בחודש השלישי

הציגו: `registration_month`, `total_customers`, `active_month_1`, `active_month_2`, `active_month_3`

---

## סיכום נקודות:
- **חלק א' (בסיסי):** 20 נקודות
- **חלק ב' (בינוני):** 30 נקודות  
- **חלק ג' (מתקדם):** 30 נקודות
- **חלק ד' (אתגר):** 20 נקודות
- **בונוס:** 10 נקודות
- **סה"כ:** 100 נקודות (+ 10 בונוס)

---

**בהצלחה!** 🚀
